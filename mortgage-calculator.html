<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-Enhanced Mortgage Calculator with interactive charts, amortization schedule, and personalized insights. Calculate monthly payments with taxes, insurance, PMI, and extra payments.">
    <meta name="keywords" content="mortgage calculator, home loan, monthly payment, amortization, property tax, PMI calculator">
    <title>AI-Enhanced Mortgage Calculator - Calculate Your Monthly Payment</title>
    
    <!-- Preload critical fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- jsPDF and html2canvas for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Original stylesheet -->
    <link rel="stylesheet" href="mortgage-calculator.css">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "AI-Enhanced Mortgage Calculator",
      "description": "Calculate your exact monthly mortgage payment with state-specific taxes, PMI, insurance, and personalized AI insights.",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
</head>

<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Calculating your mortgage...</p>
    </div>

    <!-- Toast container -->
    <div id="toast-container"></div>

    <!-- Header (matching the original design from screenshot) -->
    <header class="app-header">
        <div class="header-content">
            <h1>AI-Enhanced Mortgage Calculator</h1>
            <p>Calculate your exact monthly mortgage payment with state-specific taxes, PMI, insurance, and personalized AI insights.</p>
        </div>
    </header>

    <!-- Main Calculator Layout (3-column as shown in screenshot) -->
    <main id="main-content" class="calculator-container">
        <div class="calculator-grid">
            
            <!-- LEFT COLUMN - Mortgage Calculator Form -->
            <div class="calculator-input-column">
                <div class="card input-card">
                    <div class="panel-header">
                        <h2>Mortgage Calculator</h2>
                    </div>
                    
                    <form id="mortgage-form" class="mortgage-form">
                        
                        <!-- 1. Home Details Section -->
                        <fieldset class="form-section">
                            <legend>1. Home Details</legend>
                            
                            <div class="form-group">
                                <label for="home-price">Home Price</label>
                                <div class="input-with-prefix">
                                    <span class="input-prefix">$</span>
                                    <input type="number" id="home-price" name="homePrice" 
                                           value="400000" min="50000" max="10000000" step="1000">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="down-payment">Down Payment</label>
                                <div class="down-payment-controls">
                                    <div class="toggle-group">
                                        <button type="button" class="btn toggle-btn active" id="amount-toggle">Amount ($)</button>
                                        <button type="button" class="btn toggle-btn" id="percent-toggle">Percent (%)</button>
                                    </div>
                                    <div class="input-with-prefix">
                                        <span class="input-prefix">$</span>
                                        <input type="number" id="down-payment" name="downPayment" 
                                               value="80000" min="0" step="1000">
                                    </div>
                                    <div class="input-with-suffix" style="display: none;">
                                        <input type="number" id="down-payment-percent" name="downPaymentPercent" 
                                               value="20" min="0" max="100" step="0.5">
                                        <span class="input-suffix">%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="interest-rate">Interest Rate</label>
                                <div class="input-with-suffix">
                                    <input type="number" id="interest-rate" name="interestRate" 
                                           value="6.75" min="1" max="15" step="0.125">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="loan-term">Loan Term</label>
                                
                                <!-- Term Chips (like in original design) -->
                                <div class="term-chips">
                                    <button type="button" class="term-chip" data-term="15">15 years</button>
                                    <button type="button" class="term-chip" data-term="20">20 years</button>
                                    <button type="button" class="term-chip active" data-term="30">30 years</button>
                                </div>
                                
                                <!-- Hidden select for form submission -->
                                <select id="loan-term" name="loanTerm" style="display: none;">
                                    <option value="15">15 years</option>
                                    <option value="20">20 years</option>
                                    <option value="30" selected>30 years</option>
                                </select>
                            </div>
                        </fieldset>

                        <!-- 2. Location & Taxes -->
                        <fieldset class="form-section">
                            <legend>2. Location & Taxes</legend>
                            
                            <div class="form-group">
                                <label for="property-state">State</label>
                                <select id="property-state" name="propertyState">
                                    <option value="">Select State...</option>
                                    <!-- Populated by JavaScript -->
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="property-tax">Property Tax (Annual)</label>
                                <div class="input-with-prefix">
                                    <span class="input-prefix">$</span>
                                    <input type="number" id="property-tax" name="propertyTax" 
                                           value="3000" min="0" step="100">
                                </div>
                            </div>
                        </fieldset>

                        <!-- 3. Insurance & PMI -->
                        <fieldset class="form-section">
                            <legend>3. Insurance & PMI</legend>
                            
                            <div class="form-group">
                                <label for="home-insurance">Home Insurance (Annual)</label>
                                <div class="input-with-prefix">
                                    <span class="input-prefix">$</span>
                                    <input type="number" id="home-insurance" name="homeInsurance" 
                                           value="1700" min="0" step="50">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="pmi">PMI (Monthly)</label>
                                <div class="input-with-prefix">
                                    <span class="input-prefix">$</span>
                                    <input type="number" id="pmi" name="pmi" 
                                           value="0" min="0" step="25" readonly>
                                </div>
                                <small class="form-help">Auto-calculated for down payments &lt; 20%</small>
                            </div>
                        </fieldset>

                        <!-- 4. Extra Payments (Collapsible) -->
                        <details class="advanced-options">
                            <summary>4. Extra Payments</summary>
                            <div class="advanced-content">
                                <div class="form-group">
                                    <label for="extra-monthly">Extra Monthly Payment</label>
                                    <div class="input-with-prefix">
                                        <span class="input-prefix">$</span>
                                        <input type="number" id="extra-monthly" name="extraMonthly" 
                                               value="0" min="0" step="50">
                                    </div>
                                    <small class="form-help">Additional amount toward principal each month</small>
                                </div>

                                <div class="form-group">
                                    <label for="extra-onetime">One-Time Extra Payment</label>
                                    <div class="input-with-prefix">
                                        <span class="input-prefix">$</span>
                                        <input type="number" id="extra-onetime" name="extraOnetime" 
                                               value="0" min="0" step="100">
                                    </div>
                                    <small class="form-help">Lump sum payment (applied in month 12)</small>
                                </div>
                            </div>
                        </details>
                    </form>
                </div>
            </div>

            <!-- MIDDLE COLUMN - Your Mortgage Results -->
            <div class="calculator-results-column">
                <div class="card result-card">
                    <!-- Results Header -->
                    <div class="panel-header">
                        <h2>Your Mortgage Results</h2>
                    </div>
                    
                    <!-- Total Monthly Payment (Prominent Display) -->
                    <div class="total-payment-highlight">
                        <div class="payment-label">Total Monthly Payment</div>
                        <div class="payment-amount" id="total-payment">$2,467.18</div>
                    </div>

                    <!-- Payment Breakdown -->
                    <div class="payment-breakdown">
                        <div class="breakdown-row">
                            <span class="breakdown-label">Principal & Interest</span>
                            <span class="breakdown-value" id="principal-interest">$2,075.51</span>
                        </div>
                        <div class="breakdown-row">
                            <span class="breakdown-label">Property Tax</span>
                            <span class="breakdown-value" id="monthly-tax">$250.00</span>
                        </div>
                        <div class="breakdown-row">
                            <span class="breakdown-label">Home Insurance</span>
                            <span class="breakdown-value" id="monthly-insurance">$141.67</span>
                        </div>
                        <div class="breakdown-row">
                            <span class="breakdown-label">PMI</span>
                            <span class="breakdown-value" id="monthly-pmi">$0.00</span>
                        </div>
                    </div>

                    <!-- FIRST: Loan Summary (as requested) -->
                    <div class="loan-summary-section">
                        <h3>Loan Summary</h3>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-label">Loan Amount</div>
                                <div class="summary-value" id="display-loan-amount">$320,000</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Total Interest Paid</div>
                                <div class="summary-value" id="display-total-interest">$427,183</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Total Cost of Loan</div>
                                <div class="summary-value" id="display-total-cost">$747,183</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Payoff Date</div>
                                <div class="summary-value" id="display-payoff-date">Sep 2054</div>
                            </div>
                        </div>
                    </div>

                    <!-- SECOND: Amortization Schedule (Collapsible as requested) -->
                    <details class="amortization-details">
                        <summary class="section-header">
                            <h3>Amortization Schedule</h3>
                            <span class="expand-icon">▼</span>
                        </summary>
                        <div class="amortization-content">
                            <div class="view-controls">
                                <div class="view-toggle">
                                    <button type="button" class="toggle-btn active" data-view="monthly">Monthly</button>
                                    <button type="button" class="toggle-btn" data-view="yearly">Yearly</button>
                                </div>
                                <div class="pagination-info">
                                    <span id="pagination-text">Page 1 of 25</span>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table id="amortization-table" class="amortization-table">
                                    <thead>
                                        <tr>
                                            <th>Payment #</th>
                                            <th>Date</th>
                                            <th>Payment</th>
                                            <th>Principal</th>
                                            <th>Interest</th>
                                            <th>Balance</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="no-data">Calculate mortgage to view schedule</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="pagination-controls">
                                <button type="button" id="prev-page" class="btn btn--outline btn--sm">Previous</button>
                                <button type="button" id="next-page" class="btn btn--outline btn--sm">Next</button>
                            </div>
                        </div>
                    </details>

                    <!-- THIRD: Tabbed Content (Chart shown by default as requested) -->
                    <div class="tabbed-section">
                        <div class="tab-controls">
                            <button type="button" class="tab-btn active" data-tab="chart">Mortgage Over Time</button>
                            <button type="button" class="tab-btn" data-tab="insights">AI-Powered Insights</button>
                        </div>
                        
                        <!-- Mortgage Over Time Tab (shown by default) -->
                        <div class="tab-content active" id="chart-tab">
                            <div class="mortgage-chart-section">
                                <div class="chart-container">
                                    <canvas id="mortgage-timeline-chart"></canvas>
                                </div>
                                <div class="chart-controls">
                                    <div class="year-slider-container">
                                        <label for="year-range">View up to year:</label>
                                        <input type="range" id="year-range" min="5" max="50" value="30" step="1">
                                        <span id="year-display">30</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Insights Tab -->
                        <div class="tab-content" id="insights-tab">
                            <div class="ai-insights-section">
                                <div class="insights-list" id="ai-insights-content">
                                    <div class="insight-item">
                                        <span class="insight-icon">💡</span>
                                        <div class="insight-content">
                                            <strong>Calculate your mortgage to see personalized AI insights</strong>
                                            <p>Get smart recommendations about your loan terms, extra payments, and savings opportunities.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FOURTH: Sharing Options (as requested) -->
                    <div class="sharing-section">
                        <h3>Share Results</h3>
                        <div class="share-actions">
                            <button type="button" id="share-btn" class="btn btn--primary">
                                <span>📤</span> Share
                            </button>
                            <button type="button" id="pdf-btn" class="btn btn--secondary">
                                <span>📄</span> Download PDF
                            </button>
                            <button type="button" id="print-btn" class="btn btn--outline">
                                <span>🖨️</span> Print
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN - Sponsored Content -->
            <div class="calculator-sponsor-column">
                <div class="card sponsor-card">
                    <div class="panel-header">
                        <h3>Sponsored</h3>
                    </div>
                    <div class="sponsor-content">
                        <div class="sponsor-item">
                            <h4>Get Pre-Approved Today</h4>
                            <p>Compare rates from top lenders. No obligation, completely free.</p>
                            <button class="btn btn--primary btn--sm">Get Free Quotes</button>
                        </div>
                        
                        <div class="sponsor-item partner-offer">
                            <h4>Partner Offer</h4>
                            <h4>Home Insurance Quotes</h4>
                            <p>Save up to 30% on home insurance with our partners.</p>
                            <button class="btn btn--secondary btn--sm">Compare Quotes</button>
                        </div>
                        
                        <div class="sponsor-item">
                            <h4>Real Estate Services</h4>
                            <p>Connect with top-rated real estate agents in your area.</p>
                            <button class="btn btn--outline btn--sm">Find Agents</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Related Calculators Section (before footer as requested) -->
    <section class="related-calculators">
        <div class="section-header">
            <h2>Related Calculators</h2>
            <p>Explore more financial tools to help with your home buying journey</p>
        </div>
        
        <div class="calculator-grid">
            <div class="calculator-card">
                <div class="calculator-icon">🏠</div>
                <h3>Home Affordability</h3>
                <p>Calculate how much house you can afford based on your income</p>
                <button class="btn btn--outline btn--sm">Calculate</button>
            </div>
            
            <div class="calculator-card">
                <div class="calculator-icon">💰</div>
                <h3>Refinance Calculator</h3>
                <p>See if refinancing your mortgage could save you money</p>
                <button class="btn btn--outline btn--sm">Calculate</button>
            </div>
            
            <div class="calculator-card">
                <div class="calculator-icon">📊</div>
                <h3>Property Tax Calculator</h3>
                <p>Estimate property taxes for any location in the US</p>
                <button class="btn btn--outline btn--sm">Calculate</button>
            </div>
            
            <div class="calculator-card">
                <div class="calculator-icon">🔢</div>
                <h3>Loan Comparison</h3>
                <p>Compare multiple loan offers side by side</p>
                <button class="btn btn--outline btn--sm">Calculate</button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Financial Calculators</h4>
                <ul>
                    <li><a href="#">Mortgage Calculator</a></li>
                    <li><a href="#">Loan Calculator</a></li>
                    <li><a href="#">Investment Calculator</a></li>
                    <li><a href="#">Retirement Calculator</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Resources</h4>
                <ul>
                    <li><a href="#">Mortgage Guide</a></li>
                    <li><a href="#">Home Buying Tips</a></li>
                    <li><a href="#">Interest Rate Trends</a></li>
                    <li><a href="#">Financial Planning</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Support</h4>
                <ul>
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2024 AI Financial Calculators. All rights reserved.</p>
            <p>Disclaimer: This calculator provides estimates only. Consult with financial professionals for official advice.</p>
        </div>
    </footer>

    <!-- Enhanced JavaScript -->
    <script src="mortgage-calculator.js"></script>
</body>
</html>
