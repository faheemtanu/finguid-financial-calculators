<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mortgage Calculator – USA Financial Calculators</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    :root {
      --font-base: 'Inter', sans-serif;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-primary: #0f766e;
      --color-primary-hover: #115e59;
      --color-text: #1f2937;
      --color-text-secondary: #4b5563;
      --color-border: #d1fae5;
      --color-accent: #34d399;
      --radius: 8px;
      --shadow: 0 4px 8px rgba(0,0,0,0.04);
      --gap: 20px;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: var(--font-base);
      background: var(--color-bg);
      color: var(--color-text);
      padding: var(--gap);
    }
    h1 {
      text-align: center;
      color: var(--color-primary);
      font-weight: 600;
      margin-bottom: var(--gap);
    }
    .calculator-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--gap);
      max-width: 1000px;
      margin: 0 auto;
    }
    form, #results {
      background: var(--color-surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: var(--gap);
    }
    label { display: block; font-weight: 600; margin-top: 12px; color: var(--color-primary); }
    input, select {
      width: 100%;
      padding: 10px;
      border: 2px solid #e5e7eb;
      border-radius: var(--radius);
      margin-top: 6px;
      font-size: 1rem;
      color: var(--color-text);
    }
    input:focus, select:focus { border-color: var(--color-primary); outline: none; }
    .checkbox-label {
      display: flex; align-items: center;
      margin-top: 12px;
      font-weight: 400;
      color: var(--color-text-secondary);
    }
    .checkbox-label input { margin-right: 8px; }
    button {
      width: 100%;
      padding: 14px;
      margin-top: var(--gap);
      background: var(--color-primary);
      color: #fff;
      border: none;
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: var(--color-primary-hover); }
    #results { display: none; }
    #results h2 { color: var(--color-primary); margin-bottom: var(--gap); }
    .breakdown { list-style: none; padding: 0; }
    .breakdown li {
      display: flex; justify-content: space-between;
      padding: 6px 0; border-bottom: 1px solid var(--color-border);
      color: var(--color-text-secondary);
    }
    .breakdown li:last-child { border-bottom: none; }
    .hidden { display: none; }
    .toggle-btn {
      background: var(--color-accent);
      color: #065f46;
      border: none;
      padding: 12px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: background 0.3s;
      margin: var(--gap) auto 0;
      display: block;
    }
    .toggle-btn:hover { background: #22c55e; color: #fff; }
    #amortization { display: none; margin-top: var(--gap); }
    #amortization table {
      width: 100%;
      border-collapse: collapse;
    }
    #amortization th, #amortization td {
      border: 1px solid #cbd5e1;
      padding: 8px;
      text-align: right;
      font-size: 0.9rem;
    }
    #amortization th {
      background: #e0f2f1;
      color: var(--color-primary);
    }
    @media (max-width: 768px) {
      .calculator-container { grid-template-columns: 1fr; }
      .toggle-btn { width: 100%; }
    }
  </style>
</head>
<body>
  <h1>Mortgage Calculator</h1>
  <div class="calculator-container">
    <form id="mortgageForm" novalidate>
      <label for="homePrice">Home Price ($)</label>
      <input type="number" id="homePrice" min="0" required placeholder="400000" />
      <label for="downPayment">Down Payment ($)</label>
      <input type="number" id="downPayment" min="0" required placeholder="80000" />
      <label for="interestRate">Interest Rate (%)</label>
      <input type="number" id="interestRate" min="0" step="0.01" required placeholder="6.5" />
      <label for="loanTerm">Loan Term (Years)</label>
      <select id="loanTerm" required>
        <option value="15">15</option>
        <option value="20">20</option>
        <option value="25">25</option>
        <option value="30" selected>30</option>
      </select>
      <label for="state">State</label>
      <select id="state" required>
        <option value="">Select State</option>
      </select>
      <label for="propertyTax">Annual Property Tax ($)</label>
      <input type="number" id="propertyTax" min="0" required placeholder="4800" />
      <label for="homeInsurance">Annual Home Insurance ($)</label>
      <input type="number" id="homeInsurance" min="0" required placeholder="1200" />
      <label for="hoaFees">Monthly HOA Fees ($)</label>
      <input type="number" id="hoaFees" min="0" step="0.01" placeholder="0" />
      <label class="checkbox-label">
        <input type="checkbox" id="pmiCheckbox" /> PMI Required
      </label>
      <div id="pmiSection" class="hidden">
        <label for="pmiRate">PMI Rate (% annual)</label>
        <input type="number" id="pmiRate" min="0" step="0.01" placeholder="0.5" />
      </div>
      <button type="submit">Calculate</button>
    </form>

    <div id="results">
      <h2>Payment Breakdown</h2>
      <div><strong>Total Monthly:</strong> <span id="totalMonthly"></span></div>
      <ul class="breakdown">
        <li>Principal & Interest: <span id="principalInterest"></span></li>
        <li>Property Tax: <span id="propertyTaxDisplay"></span></li>
        <li>Insurance: <span id="homeInsuranceDisplay"></span></li>
        <li>HOA Fees: <span id="hoaFeesDisplay"></span></li>
        <li id="pmiRow" class="hidden">PMI: <span id="pmiDisplay"></span></li>
      </ul>
      <div><strong>Total Interest:</strong> <span id="totalInterest"></span></div>
      <div><small>Term: <span id="loanTermDisplay"></span> years • State: <span id="selectedStateName"></span></small></div>
    </div>
  </div>

  <button class="toggle-btn" id="toggleAmortizationBtn">Show Amortization Schedule</button>
  <div id="amortization">
    <table>
      <thead>
        <tr><th>Year</th><th>Principal</th><th>Interest</th><th>Balance</th></tr>
      </thead>
      <tbody id="amortizationTableBody"></tbody>
    </table>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const states = [
        "AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA",
        "KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ",
        "NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT",
        "VA","WA","WV","WI","WY"
      ];
      const stateNames = {
        AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",
        CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",
        IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",
        ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",
        MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",
        NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",
        OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",
        SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",
        WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"
      };
      const stateSelect = document.getElementById("state");
      states.forEach(c => {
        const opt = document.createElement("option");
        opt.value = c; opt.textContent = stateNames[c];
        stateSelect.appendChild(opt);
      });

      const pmiCheckbox = document.getElementById("pmiCheckbox");
      pmiCheckbox.addEventListener("change", () => {
        document.getElementById("pmiSection").classList.toggle("hidden", !pmiCheckbox.checked);
      });

      const toggleBtn = document.getElementById("toggleAmortizationBtn");
      toggleBtn.addEventListener("click", () => {
        const amo = document.getElementById("amortization");
        const shown = !amo.classList.toggle("hidden");
        toggleBtn.textContent = shown ? "Hide Amortization Schedule" : "Show Amortization Schedule";
      });

      function formatUSD(v){
        return v.toLocaleString("en-US",{style:"currency",currency:"USD"});
      }

      function calculateMortgage(){
        const hp = parseFloat(document.getElementById("homePrice").value)||0;
        const dp = parseFloat(document.getElementById("downPayment").value)||0;
        const ir = parseFloat(document.getElementById("interestRate").value)||0;
        const term = parseInt(document.getElementById("loanTerm").value)||30;
        const pt = parseFloat(document.getElementById("propertyTax").value)||0;
        const ins = parseFloat(document.getElementById("homeInsurance").value)||0;
        const hoa= parseFloat(document.getElementById("hoaFees").value)||0;
        let pmiR = parseFloat(document.getElementById("pmiRate").value);
        if(isNaN(pmiR)) pmiR = 0.5;
        if(hp<=0){alert("Enter valid home price");return;}
        const loan = hp-dp;
        const mir = ir/100/12;
        const n = term*12;
        let pi = mir===0? loan/n
          : loan*mir*Math.pow(1+mir,n)/(Math.pow(1+mir,n)-1);
        const mpt = pt/12, min = ins/12;
        const ltv=loan/hp;
        const pmi = (pmiCheckbox.checked||ltv>0.8) ? loan*(pmiR/100)/12 : 0;
        const total = pi+mpt+min+hoa+pmi;
        const totInt = pi*n - loan;
        document.getElementById("totalMonthly").textContent = formatUSD(total);
        document.getElementById("principalInterest").textContent = formatUSD(pi);
        document.getElementById("propertyTaxDisplay").textContent = formatUSD(mpt);
        document.getElementById("homeInsuranceDisplay").textContent = formatUSD(min);
        document.getElementById("hoaFeesDisplay").textContent = formatUSD(hoa);
        const pmiRow = document.getElementById("pmiRow");
        if(pmi>0){
          pmiRow.classList.remove("hidden");
          document.getElementById("pmiDisplay").textContent = formatUSD(pmi);
        } else pmiRow.classList.add("hidden");
        document.getElementById("totalInterest").textContent = formatUSD(totInt);
        document.getElementById("loanTermDisplay").textContent = term;
        const st = document.getElementById("state").value;
        document.getElementById("selectedStateName").textContent = stateNames[st]||"";
        document.getElementById("results").style.display = "block";
        generateAmortization(loan,mir,n,pi);
      }

      function generateAmortization(loan,mir,n,pmt){
        const tbody = document.getElementById("amortizationTableBody");
        tbody.innerHTML="";
        let bal=loan;
        for(let yr=1; yr<=Math.ceil(n/12); yr++){
          let pYr=0,iYr=0;
          for(let m=1;m<=12;m++){
            const num=(yr-1)*12+m; if(num>n) break;
            const iPaid=bal*mir;
            const pPaid=pmt-iPaid;
            bal-=pPaid; pYr+=pPaid; iYr+=iPaid;
            if(bal<0) bal=0;
          }
          const row=document.createElement("tr");
          row.innerHTML=`<td>${yr}</td><td>${formatUSD(pYr)}</td><td>${formatUSD(iYr)}</td><td>${formatUSD(bal)}</td>`;
          tbody.appendChild(row);
          if(bal<=0) break;
        }
      }

      ["homePrice","downPayment","interestRate","loanTerm","propertyTax","homeInsurance","hoaFees","pmiRate"]
        .forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.addEventListener("input", ()=>{clearTimeout(el._t); el._t=setTimeout(calculateMortgage,300);} );
        });
      document.getElementById("state").addEventListener("change", calculateMortgage);
      document.getElementById("mortgageForm").addEventListener("submit", e=>{e.preventDefault(); calculateMortgage();});

      // Defaults & initial calc
      document.getElementById("homePrice").value="400000";
      document.getElementById("downPayment").value="80000";
      document.getElementById("interestRate").value="6.5";
      document.getElementById("loanTerm").value="30";
      document.getElementById("propertyTax").value="4800";
      document.getElementById("homeInsurance").value="1200";
      document.getElementById("hoaFees").value="0";
      calculateMortgage();
    });
  </script>
</body>
</html>
