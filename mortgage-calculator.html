<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Mortgage Calculator</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Mortgage Calculator</h1>

    <!-- Location & Taxes -->
    <div class="form-group">
      <label for="state">State</label>
      <select id="state">
        <option value="">Select State</option>
      </select>
    </div>

    <div class="form-group">
      <label for="loanAmount">Loan Amount ($)</label>
      <input type="number" id="loanAmount" placeholder="300000" min="1">
    </div>
    <div class="form-group">
      <label for="interestRate">Interest Rate (%)</label>
      <input type="number" id="interestRate" placeholder="6.5" step="0.01" min="0">
    </div>
    <div class="form-group">
      <label for="loanTerm">Loan Term (years)</label>
      <input type="number" id="loanTerm" placeholder="30" min="1">
    </div>
    <div class="form-group">
      <label for="insurance">Annual Insurance ($)</label>
      <input type="number" id="insurance" placeholder="1200" min="0">
    </div>

    <button id="calculateBtn">Calculate</button>

    <div id="result" class="result" style="display:none;">
      <h2>Your Monthly Payment</h2>
      <p id="paymentOutput"></p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Populate state dropdown
      fetch('data/state-tax-rates.json')
        .then(r => r.json())
        .then(taxRates => {
          const stateSelect = document.getElementById('state');
          Object.keys(taxRates).sort().forEach(s => {
            const o = document.createElement('option');
            o.value = s;
            o.textContent = s;
            stateSelect.appendChild(o);
          });
        })
        .catch(e => console.error('Error loading tax rates:', e));

      document.getElementById('calculateBtn').addEventListener('click', () => {
        const loan = parseFloat(document.getElementById('loanAmount').value);
        const rate = parseFloat(document.getElementById('interestRate').value)/100/12;
        const term = parseInt(document.getElementById('loanTerm').value)*12;
        const insurance = parseFloat(document.getElementById('insurance').value)/12||0;

        if (!loan || !rate || !term) {
          alert('Please fill in all fields.');
          return;
        }
        // Monthly PI
        const pi = (loan * rate) / (1 - Math.pow(1 + rate, -term));
        const total = pi + insurance;
        document.getElementById('paymentOutput').textContent = 
          `$${total.toFixed(2)}`;
        document.getElementById('result').style.display = 'block';
      });
    });
  </script>
</body>
</html>
