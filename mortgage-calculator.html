<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üá∫üá∏ USA Mortgage Calculator - World's #1 AI-Enhanced Calculator | FinGuid</title>
    <meta name="description" content="World's most advanced AI-powered USA mortgage calculator with live rates, comprehensive payment analysis for all 50 states.">
    <meta name="keywords" content="mortgage calculator, USA mortgage rates, home loan calculator, mortgage payment, FHA calculator, VA loan calculator, property tax calculator">

    <!-- Enhanced PWA Support -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#21808D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="USA Mortgage Calculator">

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="mortgage-calculator.css">

    <!-- Chart.js for Enhanced Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- jsPDF for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- HTML2Canvas for Screenshots -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Screen Reader Announcements -->
    <div id="sr-announcements" aria-live="polite" class="sr-only"></div>

    <!-- PWA Install Banner -->
    <div id="pwa-install-banner" class="pwa-install-banner" style="display: none;">
        <div class="pwa-banner-content">
            <div class="pwa-icon">üì±</div>
            <div class="pwa-text">
                <strong>Install USA Mortgage Calculator</strong>
                <span>Get instant access to America's best mortgage calculator offline!</span>
            </div>
            <div class="pwa-actions">
                <button id="pwa-install-btn" class="pwa-install-btn">Install App</button>
                <button id="pwa-dismiss-btn" class="pwa-dismiss-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Enhanced Header -->
    <header class="site-header">
        <div class="nav-container">
            <div class="brand-logo">
                <a href="#" class="logo-link" aria-label="FinGuid USA Mortgage Calculator Home">
                    <i class="fas fa-calculator logo-image" style="font-size: 32px; color: var(--usa-primary);"></i>
                    <div>
                        <strong>FinGuid USA</strong>
                        <div class="tagline">World's #1 AI Calculator</div>
                    </div>
                    <span class="usa-badge">üá∫üá∏</span>
                </a>
            </div>

            <!-- Centered Accessibility Controls in Header -->
            <div class="header-accessibility-controls">
                <button class="header-control-btn" onclick="adjustFontSize(-0.1)" aria-label="Decrease font size" title="Decrease font size">
                    <i class="fas fa-minus"></i>
                    <span class="header-control-text">A-</span>
                </button>
                <button class="header-control-btn" onclick="resetFontSize()" aria-label="Reset font size" title="Reset font size">
                    <i class="fas fa-font"></i>
                    <span class="header-control-text">Aa</span>
                </button>
                <button class="header-control-btn" onclick="adjustFontSize(0.1)" aria-label="Increase font size" title="Increase font size">
                    <i class="fas fa-plus"></i>
                    <span class="header-control-text">A+</span>
                </button>
                <button id="theme-toggle" class="header-control-btn" onclick="toggleTheme()" aria-label="Toggle dark mode" title="Toggle dark/light mode">
                    <i class="fas fa-moon theme-icon"></i>
                    <span class="header-control-text">Dark</span>
                </button>
                <button class="header-control-btn" onclick="toggleScreenReaderMode()" aria-label="Toggle screen reader mode" title="Enhanced screen reader support">
                    <i class="fas fa-universal-access"></i>
                    <span class="header-control-text">SR</span>
                </button>
            </div>

            <nav class="nav-links" aria-label="Main navigation">
                <a href="#" class="nav-link" onclick="navigateTo('/')" aria-current="page">Home</a>
                <a href="#calculators" class="nav-link" onclick="navigateTo('/calculators')">Calculators</a>
                <a href="#resources" class="nav-link" onclick="navigateTo('/resources')">Resources</a>
                <a href="#partners" class="nav-link" onclick="navigateTo('/partners')">Partners</a>
                <a href="#contact" class="nav-link" onclick="navigateTo('/contact')">Contact</a>
            </nav>

            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="Toggle mobile menu" aria-expanded="false">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </div>

        <div id="mobile-menu" class="mobile-menu">
            <div class="mobile-menu-content">
                <a href="#" class="mobile-nav-link" onclick="navigateTo('/')">üè† Home</a>
                <a href="#calculators" class="mobile-nav-link" onclick="navigateTo('/calculators')">üìä Calculators</a>
                <a href="#resources" class="mobile-nav-link" onclick="navigateTo('/resources')">üìö Resources</a>
                <a href="#partners" class="mobile-nav-link" onclick="navigateTo('/partners')">ü§ù Partners</a>
                <a href="#contact" class="mobile-nav-link" onclick="navigateTo('/contact')">üìû Contact</a>
            </div>
        </div>
    </header>

    <!-- Reduced Height USA Hero Section with Live Rates -->
    <section class="usa-hero reduced-height">
        <div class="hero-container">
            <h1 class="hero-title">
                <span class="flag-icon">üá∫üá∏</span>
                World's #1 AI-Enhanced USA Mortgage Calculator
                <span class="ai-badge">AI Powered</span>
            </h1>
            <p class="hero-description">
                Calculate mortgage payments instantly with live rates, taxes, insurance & PMI for all 50 states. 
                Features comprehensive AI insights and payment analysis.
            </p>

            <!-- Live Rates in Hero Section -->
            <div class="hero-live-rates">
                <h3 class="live-rates-title">
                    <i class="fas fa-broadcast-tower"></i>
                    Current USA Rates 
                    <span class="live-indicator">LIVE</span>
                </h3>
                <div class="hero-rates-grid">
                    <div class="hero-rate-item">
                        <div class="rate-label">30-Year Fixed</div>
                        <div class="rate-value" id="hero-rate-30-year">6.44%</div>
                        <div class="rate-change positive" id="hero-rate-30-change">+0.15%</div>
                    </div>
                    <div class="hero-rate-item">
                        <div class="rate-label">15-Year Fixed</div>
                        <div class="rate-value" id="hero-rate-15-year">5.74%</div>
                        <div class="rate-change negative" id="hero-rate-15-change">-0.08%</div>
                    </div>
                    <div class="hero-rate-item">
                        <div class="rate-label">5/1 ARM</div>
                        <div class="rate-value" id="hero-rate-arm">5.90%</div>
                        <div class="rate-change neutral" id="hero-rate-arm-change">0.00%</div>
                    </div>
                    <div class="hero-rate-item">
                        <div class="rate-label">FHA 30-Year</div>
                        <div class="rate-value" id="hero-rate-fha">6.45%</div>
                        <div class="rate-change positive" id="hero-rate-fha-change">+0.05%</div>
                    </div>
                </div>
                <div class="rates-update-time">
                    <i class="fas fa-clock"></i>
                    <span id="rates-last-update">Updated: Just now</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content with Updated Layout -->
    <main id="main-content" class="calculator-container">
        <!-- Input Section - Reduced Width (30%) -->
        <section class="input-section" style="flex: 0 0 30%;">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-home"></i>
                    USA Loan Details
                </h2>
                <div class="action-buttons">
                    <button class="action-btn secondary" onclick="clearAllInputs()" title="Clear all inputs">
                        <i class="fas fa-refresh"></i>
                        Clear
                    </button>
                </div>
            </div>

            <!-- Primary Information -->
            <div class="form-section">
                <div class="subsection-title">
                    <span class="step-number">1</span>
                    Primary Information
                </div>

                <!-- Home Price -->
                <div class="form-group">
                    <label for="home-price" class="form-label">
                        <i class="fas fa-home"></i>
                        Home Price
                        <span class="usa-context">Enter the total purchase price of your home</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="home-price" class="form-control" value="450,000" 
                               placeholder="450000" aria-describedby="home-price-help">
                    </div>
                    <small id="home-price-help" class="help-text">Average USA home price: $428,700 (Oct 2025)</small>
                    <div class="suggestion-chips">
                        <button class="suggestion-chip" onclick="setQuickValue('home-price', 300000)">$300K</button>
                        <button class="suggestion-chip" onclick="setQuickValue('home-price', 450000)">$450K</button>
                        <button class="suggestion-chip" onclick="setQuickValue('home-price', 600000)">$600K</button>
                        <button class="suggestion-chip" onclick="setQuickValue('home-price', 750000)">$750K</button>
                    </div>
                </div>

                <!-- Down Payment Toggle -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-piggy-bank"></i>
                        Down Payment
                    </label>
                    <div class="input-toggle">
                        <button type="button" class="toggle-btn active" onclick="showDownPaymentType('dollar')">Dollar Amount</button>
                        <button type="button" class="toggle-btn" onclick="showDownPaymentType('percent')">Percentage</button>
                    </div>

                    <div id="down-payment-dollar" class="input-variant active">
                        <div class="input-group">
                            <span class="input-prefix">$</span>
                            <input type="text" id="down-payment" class="form-control" value="90,000" 
                                   placeholder="90000" aria-describedby="down-payment-help">
                        </div>
                    </div>

                    <div id="down-payment-percent" class="input-variant">
                        <div class="input-group">
                            <input type="number" id="down-payment-percent" class="form-control" value="20" 
                                   min="0" max="50" placeholder="20">
                            <span class="input-suffix">%</span>
                        </div>
                    </div>
                    <small id="down-payment-help" class="help-text">Higher down payments reduce monthly payments and eliminate PMI</small>
                    <div class="suggestion-chips">
                        <button class="suggestion-chip" onclick="setQuickValue('down-payment-percent', 5)">5%</button>
                        <button class="suggestion-chip" onclick="setQuickValue('down-payment-percent', 10)">10%</button>
                        <button class="suggestion-chip" onclick="setQuickValue('down-payment-percent', 20)">20%</button>
                        <button class="suggestion-chip" onclick="setQuickValue('down-payment-percent', 25)">25%</button>
                    </div>
                </div>

                <!-- ZIP Code with City Auto-Fill -->
                <div class="form-group">
                    <label for="zip-code" class="form-label">
                        <i class="fas fa-map-marker-alt"></i>
                        Property ZIP Code
                        <span class="usa-context">Auto-fills city, state, and local tax rates</span>
                    </label>
                    <input type="text" id="zip-code" class="form-control" placeholder="12345" 
                           maxlength="5" pattern="[0-9]{5}" aria-describedby="zip-code-help">
                    <div id="zip-code-status" class="zip-status" style="display: none;"></div>
                    <div id="city-state-display" class="city-state-display" style="display: none;"></div>
                    <small id="zip-code-help" class="help-text">Enter 5-digit ZIP code for city name and local rates</small>
                </div>

                <!-- Credit Score -->
                <div class="form-group">
                    <label for="credit-score" class="form-label">
                        <i class="fas fa-chart-line"></i>
                        Credit Score
                        <span class="rate-impact-text">Higher credit scores typically qualify for lower interest rates</span>
                    </label>
                    <select id="credit-score" class="form-control" aria-describedby="credit-score-help">
                        <option value="800">Excellent (800+)</option>
                        <option value="750">Very Good (750-799)</option>
                        <option value="700" selected>Good (700-749)</option>
                        <option value="650">Fair (650-699)</option>
                        <option value="600">Poor (600-649)</option>
                        <option value="580">Bad (580-599)</option>
                    </select>
                    <div id="credit-impact" class="credit-impact" style="display: none;"></div>
                    <small id="credit-score-help" class="help-text">Your credit score significantly impacts your interest rate</small>
                </div>

                <!-- Interest Rate -->
                <div class="form-group">
                    <label for="interest-rate" class="form-label">
                        <i class="fas fa-percentage"></i>
                        Interest Rate (APR)
                    </label>
                    <div class="input-group">
                        <input type="number" id="interest-rate" class="form-control" value="6.44" 
                               min="0.1" max="20" step="0.01" placeholder="6.44" aria-describedby="interest-rate-help">
                        <span class="input-suffix">%</span>
                    </div>
                    <small id="interest-rate-help" class="help-text">Current average rate updated from live markets</small>
                </div>

                <!-- Compact Loan Type Selection -->
                <div class="form-group">
                    <div class="loan-type-group">
                        <label class="form-label">
                            <i class="fas fa-university"></i>
                            Loan Type
                        </label>
                        <div class="loan-type-selector-compact">
                            <button type="button" class="loan-type-btn-compact active" data-loan-type="conventional" onclick="selectLoanType('conventional')">
                                <i class="fas fa-home"></i>
                                <span>Conventional</span>
                            </button>
                            <button type="button" class="loan-type-btn-compact" data-loan-type="fha" onclick="selectLoanType('fha')">
                                <i class="fas fa-shield-alt"></i>
                                <span>FHA</span>
                            </button>
                            <button type="button" class="loan-type-btn-compact" data-loan-type="va" onclick="selectLoanType('va')">
                                <i class="fas fa-flag-usa"></i>
                                <span>VA</span>
                            </button>
                            <button type="button" class="loan-type-btn-compact" data-loan-type="usda" onclick="selectLoanType('usda')">
                                <i class="fas fa-tractor"></i>
                                <span>USDA</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Loan Term -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-calendar-alt"></i>
                        Loan Term
                    </label>
                    <div class="term-selector">
                        <button type="button" class="term-chip active" data-term="30" onclick="selectTerm(30)">
                            <span class="term-years">30</span>
                            <span class="term-label">years</span>
                        </button>
                        <button type="button" class="term-chip" data-term="15" onclick="selectTerm(15)">
                            <span class="term-years">15</span>
                            <span class="term-label">years</span>
                        </button>
                        <button type="button" class="term-chip" data-term="20" onclick="selectTerm(20)">
                            <span class="term-years">20</span>
                            <span class="term-label">years</span>
                        </button>
                    </div>

                    <div style="margin-top: 16px;">
                        <input type="number" id="custom-term" class="form-control" placeholder="Custom term (5-50 years)" 
                               min="5" max="50" aria-describedby="custom-term-help">
                        <small id="custom-term-help" class="help-text">Custom loan term between 5-50 years</small>
                    </div>
                </div>
            </div>

            <!-- Property & Insurance Details -->
            <div class="form-section">
                <div class="subsection-title">
                    <span class="step-number">2</span>
                    Property & Insurance Details
                </div>

                <!-- Property State (Auto-filled from ZIP) -->
                <div class="form-group">
                    <label for="property-state" class="form-label">
                        <i class="fas fa-flag-usa"></i>
                        Property State
                        <span class="usa-context">Auto-filled from ZIP code</span>
                    </label>
                    <select id="property-state" class="form-control" aria-describedby="property-state-help">
                        <option value="">Select State</option>
                        <!-- States will be populated by JavaScript -->
                    </select>
                    <small id="property-state-help" class="help-text">State determines local tax and insurance rates</small>
                </div>

                <!-- Property Tax (Auto-calculated) -->
                <div class="form-group">
                    <label for="property-tax" class="form-label">
                        <i class="fas fa-landmark"></i>
                        Property Tax (Annual)
                        <span class="auto-calc-text">Auto-calculated from ZIP code and state rates</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="property-tax" class="form-control" value="9,000" 
                               placeholder="9000" aria-describedby="property-tax-help">
                    </div>
                    <small id="property-tax-help" class="help-text">Based on local tax rates from your ZIP code</small>
                </div>

                <!-- Home Insurance (Auto-calculated) -->
                <div class="form-group">
                    <label for="home-insurance" class="form-label">
                        <i class="fas fa-shield-alt"></i>
                        Home Insurance (Annual)
                        <span class="auto-calc-text">Auto-calculated from ZIP code and state rates</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="home-insurance" class="form-control" value="1,800" 
                               placeholder="1800" aria-describedby="home-insurance-help">
                    </div>
                    <small id="home-insurance-help" class="help-text">Based on local insurance rates from your ZIP code</small>
                </div>

                <!-- PMI (Auto-calculated) -->
                <div class="form-group">
                    <label for="pmi" class="form-label">
                        <i class="fas fa-umbrella"></i>
                        PMI (Private Mortgage Insurance)
                        <span class="auto-calc-text">Auto-calculated when down payment is less than 20%</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="pmi" class="form-control" value="0" 
                               placeholder="0" aria-describedby="pmi-help">
                    </div>
                    <small id="pmi-help" class="help-text">Required for conventional loans with less than 20% down</small>
                    <div id="pmi-status" class="pmi-status" style="display: none;"></div>
                </div>

                <!-- HOA Fees -->
                <div class="form-group">
                    <label for="hoa-fees" class="form-label">
                        <i class="fas fa-building"></i>
                        HOA Fees (Monthly)
                        <span class="optional-text">Homeowner Association monthly fees</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="hoa-fees" class="form-control" placeholder="0" 
                               aria-describedby="hoa-fees-help">
                    </div>
                    <small id="hoa-fees-help" class="help-text">Monthly fees for community amenities and maintenance</small>
                </div>
            </div>

            <!-- Extra Payments (Updated) -->
            <div class="form-section">
                <div class="subsection-title">
                    <span class="step-number">3</span>
                    Extra Payments (Optional)
                </div>

                <!-- Extra Monthly Payment -->
                <div class="form-group">
                    <label for="extra-monthly" class="form-label">
                        <i class="fas fa-calendar-plus"></i>
                        Extra Monthly Payment
                        <span class="savings-preview">See impact on interest savings and loan term in AI insights</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="extra-monthly" class="form-control" placeholder="0" 
                               aria-describedby="extra-monthly-help">
                    </div>
                    <small id="extra-monthly-help" class="help-text">Additional monthly payment toward principal</small>
                </div>

                <!-- Extra Bi-Weekly Payment -->
                <div class="form-group">
                    <label for="extra-biweekly" class="form-label">
                        <i class="fas fa-calendar-week"></i>
                        Extra Bi-Weekly Payment
                        <span class="savings-preview">Additional payment every two weeks</span>
                    </label>
                    <div class="input-group">
                        <span class="input-prefix">$</span>
                        <input type="text" id="extra-biweekly" class="form-control" placeholder="0" 
                               aria-describedby="extra-biweekly-help">
                    </div>
                    <small id="extra-biweekly-help" class="help-text">Bi-weekly extra payment toward principal</small>
                </div>
            </div>

            <!-- Closing Costs -->
            <div class="form-section">
                <div class="subsection-title">
                    <span class="step-number">4</span>
                    Closing Costs Estimation
                </div>

                <div class="form-group">
                    <label for="closing-costs-percentage" class="form-label">
                        <i class="fas fa-file-invoice-dollar"></i>
                        Closing Costs
                    </label>
                    <div class="input-group">
                        <input type="number" id="closing-costs-percentage" class="form-control" value="3" 
                               min="0" max="10" step="0.1" placeholder="3">
                        <span class="input-suffix">%</span>
                    </div>
                    <div id="closing-costs-amount" class="closing-costs-amount">
                        = $13,500
                    </div>
                    <small class="help-text">Typical closing costs range from 2-5% of home price</small>
                </div>
            </div>
        </section>

        <!-- Results Section - Increased Width (40%) -->
        <section class="results-section" style="flex: 0 0 40%;">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-chart-pie"></i>
                    Monthly Payment Analysis
                </h2>
            </div>

            <!-- Enhanced Tabs for Results -->
            <div class="results-tabs">
                <button class="tab-btn active" data-tab="payment-summary" onclick="showTab('payment-summary')">
                    <i class="fas fa-calculator"></i>
                    Payment & Summary
                </button>
                <button class="tab-btn" data-tab="mortgage-chart" onclick="showTab('mortgage-chart')">
                    <i class="fas fa-chart-line"></i>
                    Mortgage Over Time
                </button>
                <button class="tab-btn" data-tab="ai-insights" onclick="showTab('ai-insights')">
                    <i class="fas fa-brain"></i>
                    AI Insights
                </button>
                <button class="tab-btn" data-tab="payment-schedule" onclick="showTab('payment-schedule')">
                    <i class="fas fa-table"></i>
                    Payment Schedule
                </button>
            </div>

            <!-- Payment Summary Tab (Default) -->
            <div id="payment-summary" class="tab-content active">
                <!-- Enhanced Main Payment Display -->
                <div class="main-payment-card">
                    <div class="payment-header">
                        <h3>Total Monthly Payment</h3>
                        <div class="loan-type-badge" id="loan-type-display">Conventional Loan</div>
                    </div>
                    <div class="payment-amount">
                        <span class="amount-value" id="total-payment">$2,768</span>
                        <div class="payment-breakdown-summary">
                            <span id="pi-summary">$2,025 P&I</span>
                            <span class="separator">+</span>
                            <span id="escrow-summary">$743 Escrow</span>
                        </div>
                    </div>
                </div>

                <!-- Colorful Payment Components Chart -->
                <div class="payment-components-chart">
                    <h3>
                        <i class="fas fa-chart-pie"></i>
                        Payment Components Chart
                    </h3>
                    <div class="chart-container">
                        <canvas id="payment-components-chart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- Enhanced Loan Summary -->
                <div class="loan-summary">
                    <h3>Loan Summary</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span class="summary-label">Loan Amount</span>
                            <span class="summary-value" id="loan-amount-summary">$360,000</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Total Interest</span>
                            <span class="summary-value" id="total-interest-summary">$367,520</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Total Cost</span>
                            <span class="summary-value" id="total-cost-summary">$727,520</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Payoff Date</span>
                            <span class="summary-value" id="payoff-date-summary">Oct 2054</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Closing Costs</span>
                            <span class="summary-value" id="closing-costs-summary">$13,500</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mortgage Over Time Chart Tab -->
            <div id="mortgage-chart" class="tab-content">
                <div class="chart-section">
                    <div class="chart-header">
                        <h3>
                            <i class="fas fa-chart-line"></i>
                            Mortgage Balance Over Time
                        </h3>
                        <div class="chart-controls">
                            <button class="chart-control-btn" onclick="toggleChartView()" title="Toggle chart view">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="chart-control-btn" onclick="downloadChart()" title="Download chart">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div class="chart-subtitle">
                        <span id="chart-loan-details">Loan: $360,000 | Term: 30 years | Rate: 6.44%</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="mortgage-timeline-chart" width="400" height="200"></canvas>
                    </div>

                    <!-- Enhanced Year Slider -->
                    <div class="year-slider-section">
                        <label for="year-range" class="slider-label">
                            <i class="fas fa-calendar-alt"></i>
                            Drag to see loan balance at any year:
                        </label>
                        <input type="range" id="year-range" class="year-slider" min="1" max="30" value="15" 
                               aria-label="Select year to view loan details">
                        <div class="year-display">
                            <span id="year-label">Year 15</span>
                        </div>
                        <div class="year-details">
                            <div class="detail-item">
                                <span class="detail-label">Principal Paid</span>
                                <span class="detail-value" id="principal-paid">$125,000</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Interest Paid</span>
                                <span class="detail-value" id="interest-paid">$200,000</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Remaining Balance</span>
                                <span class="detail-value" id="remaining-balance">$195,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced AI Insights Tab -->
            <div id="ai-insights" class="tab-content">
                <div class="ai-insights-section">
                    <div class="insights-header">
                        <h3>
                            <i class="fas fa-brain"></i>
                            AI-Powered Insights
                            <span class="ai-badge">AI Powered</span>
                        </h3>
                        <button id="refresh-insights" class="refresh-btn" onclick="generateAIInsights()" title="Refresh AI insights">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                    <div class="insights-container" id="insights-container">
                        <!-- AI insights will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Enhanced Payment Schedule Tab -->
            <div id="payment-schedule" class="tab-content">
                <div class="schedule-section">
                    <h3>
                        <i class="fas fa-table"></i>
                        Payment Schedule
                    </h3>

                    <!-- Schedule Type Toggle -->
                    <div class="schedule-type-toggle">
                        <button class="schedule-type-btn active" data-type="monthly" onclick="toggleScheduleType('monthly')">
                            <i class="fas fa-calendar-alt"></i>
                            Monthly
                        </button>
                        <button class="schedule-type-btn" data-type="weekly" onclick="toggleScheduleType('weekly')">
                            <i class="fas fa-calendar-week"></i>
                            Weekly
                        </button>
                    </div>

                    <div class="schedule-container">
                        <div class="schedule-table-wrapper">
                            <table class="schedule-table" id="amortization-table">
                                <thead>
                                    <tr>
                                        <th>Payment</th>
                                        <th>Date</th>
                                        <th>Payment</th>
                                        <th>Principal</th>
                                        <th>Interest</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="loading-row">
                                        <td colspan="6">Calculating payment schedule...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Export Options -->
                        <div class="schedule-export">
                            <button class="export-btn" onclick="exportScheduleCSV()" title="Export to CSV">
                                <i class="fas fa-file-csv"></i>
                                Export CSV
                            </button>
                            <button class="export-btn" onclick="exportSchedulePDF()" title="Export to PDF">
                                <i class="fas fa-file-pdf"></i>
                                Export PDF
                            </button>
                            <button class="export-btn" onclick="printSchedule()" title="Print Schedule">
                                <i class="fas fa-print"></i>
                                Print
                            </button>
                        </div>

                        <div class="schedule-pagination">
                            <button class="pagination-btn" id="prev-payments" onclick="showPreviousPayments()" disabled>
                                <i class="fas fa-chevron-left"></i>
                                Previous
                            </button>
                            <span class="pagination-info" id="schedule-info">Payments 1-6 of 360</span>
                            <button class="pagination-btn" id="next-payments" onclick="showNextPayments()">
                                Next
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Universal Sharing Options (Below Results) -->
            <div class="universal-sharing-section">
                <h3>
                    <i class="fas fa-share-alt"></i>
                    Share Your Results
                </h3>
                <div class="sharing-buttons">
                    <button class="share-btn primary" onclick="shareResults()" title="Share your calculation">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                    <button class="share-btn secondary" onclick="downloadPDF()" title="Download as PDF">
                        <i class="fas fa-file-pdf"></i>
                        Download
                    </button>
                    <button class="share-btn secondary" onclick="printResults()" title="Print results">
                        <i class="fas fa-print"></i>
                        Print
                    </button>
                    <button class="share-btn secondary" onclick="saveResults()" title="Save for comparison">
                        <i class="fas fa-save"></i>
                        Save Result
                    </button>
                    <button class="share-btn compare" onclick="openComparisonPage()" title="Compare loan scenarios">
                        <i class="fas fa-balance-scale"></i>
                        Compare Scenarios
                    </button>
                </div>
            </div>
        </section>

        <!-- Sidebar Section - Same Width (30%) -->
        <aside class="sidebar-section" style="flex: 0 0 30%;">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-handshake"></i>
                    Lenders & Resources
                </h2>
            </div>

            <!-- Featured Lenders -->
            <div class="lender-cards">
                <h3>
                    <i class="fas fa-star"></i>
                    Featured USA Lenders
                </h3>

                <div class="lender-card featured">
                    <div class="lender-header">
                        <div class="lender-logo">üè¶</div>
                        <div class="lender-info">
                            <h4>Rocket Mortgage</h4>
                            <div class="lender-rating">
                                <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                                <span class="rating-text">4.8/5</span>
                            </div>
                        </div>
                    </div>
                    <div class="lender-features">
                        <div class="feature-item">
                            <i class="fas fa-clock"></i>
                            Fast approval process
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-mobile-alt"></i>
                            Mobile-first experience
                        </div>
                    </div>
                    <div class="lender-rates">
                        <div class="rate-info">
                            <span class="rate-label">30-year fixed from</span>
                            <span class="rate-value">6.375%</span>
                        </div>
                    </div>
                    <button class="lender-cta" onclick="trackLender('rocket')">
                        Get Quote
                        <i class="fas fa-external-link-alt"></i>
                    </button>
                </div>

                <div class="lender-card">
                    <div class="lender-header">
                        <div class="lender-logo">üèõÔ∏è</div>
                        <div class="lender-info">
                            <h4>Better Mortgage</h4>
                            <div class="lender-rating">
                                <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="rating-text">4.6/5</span>
                            </div>
                        </div>
                    </div>
                    <div class="lender-features">
                        <div class="feature-item">
                            <i class="fas fa-dollar-sign"></i>
                            $0 lender fees
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-shield-alt"></i>
                            Rate lock guarantee
                        </div>
                    </div>
                    <div class="lender-rates">
                        <div class="rate-info">
                            <span class="rate-label">30-year fixed from</span>
                            <span class="rate-value">6.425%</span>
                        </div>
                    </div>
                    <button class="lender-cta" onclick="trackLender('better')">
                        Get Quote
                        <i class="fas fa-external-link-alt"></i>
                    </button>
                </div>

                <div class="lender-card">
                    <div class="lender-header">
                        <div class="lender-logo">üè®</div>
                        <div class="lender-info">
                            <h4>Chase Home Lending</h4>
                            <div class="lender-rating">
                                <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="rating-text">4.4/5</span>
                            </div>
                        </div>
                    </div>
                    <div class="lender-features">
                        <div class="feature-item">
                            <i class="fas fa-university"></i>
                            Major bank stability
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-users"></i>
                            Relationship discounts
                        </div>
                    </div>
                    <div class="lender-rates">
                        <div class="rate-info">
                            <span class="rate-label">30-year fixed from</span>
                            <span class="rate-value">6.500%</span>
                        </div>
                    </div>
                    <button class="lender-cta" onclick="trackLender('chase')">
                        Get Quote
                        <i class="fas fa-external-link-alt"></i>
                    </button>
                </div>
            </div>

            <!-- USA Housing Market Insights -->
            <div class="market-insights">
                <h3>
                    <i class="fas fa-chart-trending-up"></i>
                    USA Housing Market
                </h3>
                <div class="market-stats">
                    <div class="stat-item">
                        <div class="stat-icon">üè†</div>
                        <div class="stat-info">
                            <div class="stat-label">Median Home Price</div>
                            <div class="stat-value">$428,700</div>
                            <div class="stat-change positive">+8.2% YoY</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-info">
                            <div class="stat-label">30-Year Fixed Rate</div>
                            <div class="stat-value">6.44%</div>
                            <div class="stat-change positive">+0.15% this week</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <div class="stat-label">Housing Inventory</div>
                            <div class="stat-value">4.2 months</div>
                            <div class="stat-change negative">-2.1% from last month</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- USA Government Programs -->
            <div class="government-programs">
                <h3>
                    <i class="fas fa-flag-usa"></i>
                    USA Government Programs
                </h3>
                <div class="program-list">
                    <div class="program-item">
                        <div class="program-icon">üèõÔ∏è</div>
                        <div class="program-info">
                            <h4>FHA Loans</h4>
                            <p>3.5% down payment minimum, flexible credit requirements</p>
                            <a href="#" class="program-link">Learn More</a>
                        </div>
                    </div>
                    <div class="program-item">
                        <div class="program-icon">üá∫üá∏</div>
                        <div class="program-info">
                            <h4>VA Loans</h4>
                            <p>$0 down for qualified veterans and service members</p>
                            <a href="#" class="program-link">Check Eligibility</a>
                        </div>
                    </div>
                    <div class="program-item">
                        <div class="program-icon">üåæ</div>
                        <div class="program-info">
                            <h4>USDA Rural Loans</h4>
                            <p>$0 down for eligible rural and suburban areas</p>
                            <a href="#" class="program-link">See Areas</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advertisement/Sponsor Section -->
            <div class="sponsor-section">
                <h3>
                    <i class="fas fa-ad"></i>
                    Sponsored
                </h3>
                <div class="sponsor-ad">
                    <div class="ad-content">
                        <div class="ad-logo">üí∞</div>
                        <div class="ad-text">
                            <h4>First-Time Homebuyer?</h4>
                            <p>Get up to $15,000 in down payment assistance. Check your eligibility now!</p>
                        </div>
                    </div>
                    <button class="ad-cta">Learn More</button>
                </div>

                <div class="sponsor-ad">
                    <div class="ad-content">
                        <div class="ad-logo">üè¶</div>
                        <div class="ad-text">
                            <h4>Refinance Special</h4>
                            <p>Rates as low as 5.99% APR. No closing costs for qualified borrowers.</p>
                        </div>
                    </div>
                    <button class="ad-cta">Get Quote</button>
                </div>
            </div>
        </aside>
    </main>

    <!-- Enhanced Footer (Removed Data Sources) -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>
                        <i class="fas fa-calculator"></i>
                        FinGuid USA
                    </h3>
                    <p>World's #1 AI-Enhanced USA Mortgage Calculator. Calculate payments instantly with live rates, taxes, insurance & PMI for all 50 states.</p>
                    <div class="footer-social">
                        <a href="#" class="social-link" aria-label="Facebook">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="LinkedIn">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>

                <div class="footer-links">
                    <div class="footer-column">
                        <h4>Calculators</h4>
                        <ul>
                            <li><a href="#">Mortgage Calculator</a></li>
                            <li><a href="#">Refinance Calculator</a></li>
                            <li><a href="#">Affordability Calculator</a></li>
                            <li><a href="#">FHA Calculator</a></li>
                            <li><a href="#">VA Loan Calculator</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4>Resources</h4>
                        <ul>
                            <li><a href="#">Mortgage Rates</a></li>
                            <li><a href="#">First-Time Buyers</a></li>
                            <li><a href="#">Government Programs</a></li>
                            <li><a href="#">Market Analysis</a></li>
                            <li><a href="#">Blog</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4>Tools</h4>
                        <ul>
                            <li><a href="#">Rate Comparison</a></li>
                            <li><a href="#">Lender Reviews</a></li>
                            <li><a href="#">Payment Calculator</a></li>
                            <li><a href="#">Tax Calculator</a></li>
                            <li><a href="#">Insurance Calculator</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4>Company</h4>
                        <ul>
                            <li><a href="#">About Us</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Terms of Service</a></li>
                            <li><a href="#">Contact</a></li>
                            <li><a href="#">Support</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <div class="footer-disclaimer">
                    <p><strong>Disclaimer:</strong> This calculator provides estimates only. Actual loan terms may vary. Rates and payments shown are for illustration purposes. Consult with qualified lenders for accurate quotes.</p>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 FinGuid USA. All rights reserved. | World's First AI Calculator Platform for Americans</p>
                    <div class="footer-badges">
                        <span class="badge">üá∫üá∏ Made in USA</span>
                        <span class="badge">üîí SSL Secure</span>
                        <span class="badge">‚ôø WCAG 2.1 AA</span>
                        <span class="badge">üì± PWA Ready</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Indicator -->
    <div id="loading-indicator" class="loading-indicator" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Calculating...</div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="mortgage-calculator.js"></script>
</body>
</html>
