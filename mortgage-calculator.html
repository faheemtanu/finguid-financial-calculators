<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mortgage Calculator â€“ USA Financial Calculators</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    /* Root color vars matching branding */
    :root {
      --font-base: 'Inter', sans-serif;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-primary: #1e40af;
      --color-primary-dark: #2563eb;
      --color-accent: #34d399;
      --color-text: #1f2937;
      --color-text-secondary: #4b5563;
      --color-border: #dbeafe;
      --color-insight-bg: #e0f2fe;
      --radius: 10px;
      --gap: 20px;
      --shadow: 0 4px 8px rgb(0 0 0 / 0.1);
    }
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    body {
      font-family: var(--font-base);
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.5;
    }
    /* Header navbar */
    header {
      background: var(--color-surface);
      padding: 16px 32px;
      box-shadow: var(--shadow);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    header .logo {
      font-weight: 700;
      font-size: 1.5rem;
      color: var(--color-primary);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    header .logo i {
      font-size: 1.6rem;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 24px;
    }
    nav ul li a {
      color: var(--color-text);
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      transition: color 0.3s;
    }
    nav ul li a:hover {
      color: var(--color-primary);
    }
    /* Page container */
    main {
      max-width: 1100px;
      margin: 40px auto 80px auto;
      padding: 0 16px;
    }
    h1 {
      text-align: center;
      color: var(--color-primary);
      margin-bottom: var(--gap);
      font-weight: 700;
      font-size: 2.5rem;
    }
    /* Calculator grid: form left, results right */
    .calculator-grid {
      display: grid;
      grid-template-columns: 1fr 1.1fr;
      gap: var(--gap);
      background: var(--color-surface);
      padding: var(--gap);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      min-height: 450px;
    }
    @media (max-width: 900px) {
      .calculator-grid {
        grid-template-columns: 1fr;
      }
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    label {
      font-weight: 600;
      color: var(--color-primary);
      font-size: 1rem;
    }
    input[type=number], select {
      padding: 10px 12px;
      font-size: 1rem;
      border: 2px solid var(--color-border);
      border-radius: var(--radius);
      color: var(--color-text);
      outline-offset: 2px;
      transition: border-color 0.3s;
    }
    input[type=number]:focus, select:focus {
      border-color: var(--color-primary);
      outline: none;
    }
    .checkbox-label {
      display: flex;
      align-items: center;
      color: var(--color-text-secondary);
      font-weight: 500;
      margin-top: 20px;
      gap: 6px;
      user-select: none;
    }
    .checkbox-label input {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    button.calculate-btn {
      margin-top: 24px;
      padding: 16px 0;
      background: var(--color-primary);
      color: white;
      font-weight: 700;
      font-size: 1.1rem;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: background-color 0.25s;
    }
    button.calculate-btn:hover {
      background: var(--color-primary-dark);
    }
    /* Results panel */
    #result-section {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      background: var(--color-bg);
      padding: var(--gap);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      min-height: 400px;
    }
    #results {
      background: var(--color-surface);
      padding: var(--gap);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      display: none;
      margin-bottom: var(--gap);
    }
    #results h2 {
      color: var(--color-primary);
      margin-bottom: 16px;
      font-weight: 700;
      font-size: 1.5rem;
    }
    ul.breakdown {
      list-style: none;
      margin-bottom: var(--gap);
    }
    ul.breakdown li {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid var(--color-border);
      padding: 8px 0;
      font-weight: 600;
      font-size: 1rem;
      color: var(--color-text-secondary);
    }
    ul.breakdown li:last-child {
      border-bottom: none;
      font-weight: 700;
      color: var(--color-primary);
    }
    /* Additional info */
    #loan-info {
      font-size: 0.9rem;
      color: var(--color-text-secondary);
      text-align: center;
      margin-bottom: var(--gap);
    }
    /* If PMI row */
    #pmi-row {
      display: none;
      justify-content: space-between;
      padding: 8px 0;
      font-weight: 600;
      color: var(--color-text-secondary);
      border-bottom: 1px solid var(--color-border);
    }
    #pmi-row span:last-child {
      font-weight: 700;
      color: var(--color-primary);
    }

    /* Toggle button */
    #toggle-amort-btn {
      width: 100%;
      background: var(--color-accent);
      color: #064e3b;
      border: none;
      padding: 14px 0;
      font-size: 1.1rem;
      font-weight: 700;
      border-radius: var(--radius);
      cursor: pointer;
      transition: background-color 0.3s;
      user-select: none;
      margin-top: auto;
    }
    #toggle-amort-btn:hover {
      background: #16a34a;
      color: white;
    }

    /* Amortization Table */
    #amortization-table {
      font-size: 0.9rem;
      border-collapse: collapse;
      width: 100%;
      margin-top: var(--gap);
      display: none;
    }
    #amortization-table th, #amortization-table td {
      border: 1px solid var(--color-border);
      padding: 8px;
      text-align: right;
    }
    #amortization-table th {
      background: var(--color-accent);
      color: var(--color-bg);
      font-weight: 700;
    }

    /* AI insights box */
    #ai-insights {
      margin-top: var(--gap);
      background: var(--color-insight-bg);
      border-left: 5px solid var(--color-accent);
      padding: 16px;
      font-size: 1rem;
      color: var(--color-primary);
      font-weight: 600;
      border-radius: var(--radius);
      display: none;
      line-height: 1.3;
    }

    /* Responsive */
    @media (max-width: 900px) {
      .calculator-grid {
        grid-template-columns: 1fr;
      }
      #toggle-amort-btn {
        margin-top: var(--gap);
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="/" class="logo"><i class="fas fa-calculator"></i> USA Financial Calculators</a>
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/calculators">Calculators</a></li>
        <li><a href="/resources">Resources</a></li>
        <li><a href="/partners">Partners</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h1>Mortgage Calculator</h1>

    <section class="calculator-grid">
      <form id="mortgage-form" novalidate>
        <label for="home-price">Home Price ($)</label>
        <input type="number" id="home-price" min="0" required value="400000" />
        
        <label for="down-payment">Down Payment ($)</label>
        <input type="number" id="down-payment" min="0" required value="80000" />
        
        <label for="interest-rate">Interest Rate (%)</label>
        <input type="number" id="interest-rate" min="0" step="0.01" required value="6.5" />
        
        <label for="loan-term">Loan Term (Years)</label>
        <select id="loan-term" required>
          <option value="15">15 Years</option>
          <option value="20">20 Years</option>
          <option value="25">25 Years</option>
          <option value="30" selected>30 Years</option>
        </select>
        
        <label for="state">State</label>
        <select id="state" required></select>
        
        <label for="property-tax">Annual Property Tax ($)</label>
        <input type="number" id="property-tax" min="0" required value="4800" />
        
        <label for="home-insurance">Annual Home Insurance ($)</label>
        <input type="number" id="home-insurance" min="0" required value="1200" />
        
        <label for="hoa-fees">Monthly HOA Fees ($)</label>
        <input type="number" id="hoa-fees" min="0" step="0.01" value="0" />
        
        <div class="checkbox-label">
          <input type="checkbox" id="pmi-required" />
          <label for="pmi-required" style="font-weight: 600; color: var(--color-primary); margin-left:4px;">PMI Required</label>
        </div>
        
        <div id="pmi-section" style="display:none;">
          <label for="pmi-rate">PMI Rate (% Annual)</label>
          <input type="number" id="pmi-rate" placeholder="0.5" step="0.01" min="0" />
        </div>
        
        <button type="submit" class="calculate-btn">Calculate</button>
      </form>

      <section id="result-section">
        <div id="results" aria-live="polite" aria-atomic="true">
          <h2>Payment Breakdown</h2>
          <div><strong>Total Monthly Payment:</strong> <span id="total-monthly"></span></div>
          <ul class="breakdown">
            <li><span>Principal & Interest</span><span id="principal-interest"></span></li>
            <li><span>Property Tax</span><span id="property-tax-amt"></span></li>
            <li><span>Home Insurance</span><span id="home-insurance-amt"></span></li>
            <li><span>HOA Fees</span><span id="hoa-fees-amt"></span></li>
            <li id="pmi_row" style="display:none;"><span>PMI</span><span id="pmi-amt"></span></li>
          </ul>
          <div><strong>Total Interest Over Life of Loan: </strong><span id="total-interest"></span></div>
          <div id="loan-info"></div>
        </div>

        <button id="toggle-amort-btn">Show Amortization Schedule</button>

        <table id="amortization-table" aria-label="Amortization schedule">
          <thead>
            <tr>
              <th>Year</th>
              <th>Principal Paid</th>
              <th>Interest Paid</th>
              <th>Remaining Balance</th>
            </tr>
          </thead>
          <tbody id="amortization-body"></tbody>
        </table>
        
        <section id="ai-insights" aria-live="polite" aria-atomic="true"></section>
      </section>
    </section>
  </main>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const states = [
      { code: 'AL', name: 'Alabama' }, { code: 'AK', name: 'Alaska' }, { code: 'AZ', name: 'Arizona' },
      { code: 'AR', name: 'Arkansas' }, { code: 'CA', name: 'California' }, { code: 'CO', name: 'Colorado' },
      { code: 'CT', name: 'Connecticut' }, { code: 'DE', name: 'Delaware' }, { code: 'FL', name: 'Florida' },
      { code: 'GA', name: 'Georgia' }, { code: 'HI', name: 'Hawaii' }, { code: 'ID', name: 'Idaho' },
      { code: 'IL', name: 'Illinois' }, { code: 'IN', name: 'Indiana' }, { code: 'IA', name: 'Iowa' },
      { code: 'KS', name: 'Kansas' }, { code: 'KY', name: 'Kentucky' }, { code: 'LA', name: 'Louisiana' },
      { code: 'ME', name: 'Maine' }, { code: 'MD', name: 'Maryland' }, { code: 'MA', name: 'Massachusetts' },
      { code: 'MI', name: 'Michigan' }, { code: 'MN', name: 'Minnesota' }, { code: 'MS', name: 'Mississippi' },
      { code: 'MO', name: 'Missouri' }, { code: 'MT', name: 'Montana' }, { code: 'NE', name: 'Nebraska' },
      { code: 'NV', name: 'Nevada' }, { code: 'NH', name: 'New Hampshire' }, { code: 'NJ', name: 'New Jersey' },
      { code: 'NM', name: 'New Mexico' }, { code: 'NY', name: 'New York' }, { code: 'NC', name: 'North Carolina' },
      { code: 'ND', name: 'North Dakota' }, { code: 'OH', name: 'Ohio' }, { code: 'OK', name: 'Oklahoma' },
      { code: 'OR', name: 'Oregon' }, { code: 'PA', name: 'Pennsylvania' }, { code: 'RI', name: 'Rhode Island' },
      { code: 'SC', name: 'South Carolina' }, { code: 'SD', name: 'South Dakota' }, { code: 'TN', name: 'Tennessee' },
      { code: 'TX', name: 'Texas' }, { code: 'UT', name: 'Utah' }, { code: 'VT', name: 'Vermont' },
      { code: 'VA', name: 'Virginia' }, { code: 'WA', name: 'Washington' }, { code: 'WV', name: 'West Virginia' },
      { code: 'WI', name: 'Wisconsin' }, { code: 'WY', name: 'Wyoming' }
    ];
    const stateSelect = document.getElementById('state');
    states.forEach(({code,name}) => {
      const option = document.createElement('option');
      option.value = code; option.textContent = name;
      stateSelect.appendChild(option);
    });

    const pmiCheckbox = document.getElementById('pmi-required');
    const pmiSection = document.getElementById('pmi-section');
    
    pmiCheckbox.addEventListener('change', () => {
      pmiSection.style.display = pmiCheckbox.checked ? 'block' : 'none';
    });

    const toggleAmortBtn = document.getElementById('toggle-amort-btn');
    const amortTable = document.getElementById('amortization-table');
    let amortVisible = false;
    toggleAmortBtn.addEventListener('click', () => {
      amortVisible = !amortVisible;
      amortTable.style.display = amortVisible ? 'table' : 'none';
      toggleAmortBtn.textContent = amortVisible ? 'Hide Amortization Schedule' : 'Show Amortization Schedule';
    });

    const form = document.getElementById('mortgage-form');
    const resultsSection = document.getElementById('results');
    const aiInsights = document.getElementById('ai-insights');
    
    function formatUSD(num) {
      return num.toLocaleString('en-US', {style:'currency', currency:'USD'});
    }
    
    function generateAmortizationSchedule(loanAmount, monthlyRate, totalPayments, monthlyPayment) {
      const tbody = document.getElementById('amortization-body');
      tbody.innerHTML = '';
      let balance = loanAmount;
      for(let year=1; year <= Math.ceil(totalPayments/12); year++) {
        let interestPaidYear = 0, principalPaidYear = 0;
        for(let month = 1; month <= 12; month++) {
          let paymentNumber = (year - 1)*12 + month;
          if(paymentNumber > totalPayments) break;
          let interestPayment = balance * monthlyRate;
          let principalPayment = monthlyPayment - interestPayment;
          balance -= principalPayment;
          principalPaidYear += principalPayment;
          interestPaidYear += interestPayment;
          if(balance <= 0) {
            balance = 0;
            break;
          }
        }
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${year}</td>
          <td>${formatUSD(principalPaidYear)}</td>
          <td>${formatUSD(interestPaidYear)}</td>
          <td>${formatUSD(balance)}</td>
        `;
        tbody.appendChild(row);
        if(balance <= 0) break;
      }
    }
    
    function computeAIInsights(totalPayment, principalInterest, propertyTax, insurance, hoaFees, pmi) {
      // AI insight examples based on calculation data
      const insights = [];
      // Suggest increasing down payment to reduce PMI/interest if high
      if(pmi > 0) {
        insights.push("Your PMI is applied because your down payment is less than 20%. Increasing your down payment could reduce this cost.");
      }
      // Suggest paying extra principal if interest is very high
      const interestRatio = totalPayment - (principalInterest + propertyTax + insurance + hoaFees + pmi);
      if(interestRatio/totalPayment > 0.3) {
        insights.push("A significant portion of your monthly payment goes towards interest. Consider making extra principal payments to reduce total interest paid.");
      }
      if(insights.length === 0) {
        insights.push("Your mortgage setup is balanced. Keep monitoring market rates for better loans.");
      }
      return insights;
    }

    async function fetchAILoanInsights(formData) {
      // Simulate AI powered call - here just prepare guidance text
      // In real system, connect to AI backend (e.g., OpenAI API)
      return computeAIInsights(formData.totalMonthly, formData.principalInterest, formData.propertyTaxAmt, formData.insuranceAmt, formData.hoaFeesAmt, formData.pmiAmt);
    }

    async function calculateMortgage(e) {
      if(e) e.preventDefault();

      const homePrice = parseFloat(document.getElementById('home-price').value) || 0;
      const downPayment = parseFloat(document.getElementById('down-payment').value) || 0;
      const interestRate = parseFloat(document.getElementById('interest-rate').value) || 0;
      const loanTerm = parseInt(document.getElementById('loan-term').value) || 30;
      const state = document.getElementById('state').value;
      const propertyTax = parseFloat(document.getElementById('property-tax').value) || 0;
      const homeInsurance = parseFloat(document.getElementById('home-insurance').value) || 0;
      const hoaFees = parseFloat(document.getElementById('hoa-fees').value) || 0;
      const pmiRequired = pmiCheckbox.checked;
      let pmiRate = parseFloat(document.getElementById('pmi-rate').value);
      if(isNaN(pmiRate)) pmiRate = 0.5; // default PMI % per year

      // Input validation
      if(homePrice <= 0) return alert("Please enter a valid home price");
      if(downPayment < 0 || downPayment > homePrice) return alert("Down payment must be between 0 and home price");
      if(interestRate <= 0) return alert("Please enter a valid interest rate");
      if(loanTerm <= 0) return alert("Please enter a valid loan term");
      if(!state) return alert("Please select a valid state");

      const loanAmount = homePrice - downPayment;
      const monthlyInterestRate = interestRate / 100 / 12;
      const totalPayments = loanTerm * 12;

      // Calculate monthly principal and interest
      let monthlyPI;
      if(monthlyInterestRate === 0) {
        monthlyPI = loanAmount / totalPayments;
      } else {
        monthlyPI = loanAmount * monthlyInterestRate * Math.pow(1 + monthlyInterestRate, totalPayments) 
                  / (Math.pow(1 + monthlyInterestRate, totalPayments) -1);
      }

      const monthlyPropertyTax = propertyTax / 12;
      const monthlyInsurance = homeInsurance / 12;
      const monthlyHOAFees = hoaFees;

      const loanToValue = loanAmount / homePrice;
      let monthlyPMI = 0;
      if(pmiRequired || loanToValue > 0.8) {
        monthlyPMI = (loanAmount * pmiRate / 100) / 12;
        document.getElementById('pmi_row').style.display = 'flex';
      } else {
        document.getElementById('pmi_row').style.display = 'none';
      }

      const totalMonthlyPayment = monthlyPI + monthlyPropertyTax + monthlyInsurance + monthlyHOAFees + monthlyPMI;
      const totalInterestPaid = (monthlyPI * totalPayments) - loanAmount;

      // Display results
      document.getElementById('total-monthly').textContent = formatUSD(totalMonthlyPayment);
      document.getElementById('principal-interest').textContent = formatUSD(monthlyPI);
      document.getElementById('property-tax-amt').textContent = formatUSD(monthlyPropertyTax);
      document.getElementById('home-insurance-amt').textContent = formatUSD(monthlyInsurance);
      document.getElementById('hoa-fees-amt').textContent = formatUSD(monthlyHOAFees);
      document.getElementById('pmi-amt').textContent = formatUSD(monthlyPMI);
      document.getElementById('total-interest').textContent = formatUSD(totalInterestPaid);

      // Loan info
      document.getElementById('loan-info').textContent = `Loan term: ${loanTerm} years | State: ${states.find(s => s.code === state).name}`;
      document.getElementById('results').style.display = 'block';

      // Generate amortization schedule
      generateAmortizationSchedule(loanAmount, monthlyInterestRate, totalPayments, monthlyPI);

      // Show AI insights
      const aiTexts = await fetchAILoanInsights({
        totalMonthly: totalMonthlyPayment,
        principalInterest: monthlyPI,
        propertyTaxAmt: monthlyPropertyTax,
        insuranceAmt: monthlyInsurance,
        hoaFeesAmt: monthlyHOAFees,
        pmiAmt: monthlyPMI,
      });
      aiInsights.style.display = 'block';
      aiInsights.innerHTML = '<strong>AI-Powered Insights:</strong><ul>' + aiTexts.map(t=>`<li>${t}</li>`).join('') + '</ul>';
    }

    form.addEventListener('submit', calculateMortgage);
    // Also recalc on input blur (optional)
    ['home-price', 'down-payment', 'interest-rate', 'loan-term', 'state', 'property-tax', 'home-insurance', 'hoa-fees', 'pmi-rate', 'pmi-required']
      .forEach(id => {
        const el = document.getElementById(id);
        if(el) el.addEventListener('change', () => setTimeout(calculateMortgage, 300));
      });

    // Populate states and initial calc triggered on DOM ready already in script above
  });
</script>
</body>
</html>
